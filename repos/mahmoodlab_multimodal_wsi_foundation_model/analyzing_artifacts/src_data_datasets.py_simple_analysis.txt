Implemented. I wrote the requested logic analysis into:

- [src/data/datasets.py](/Users/mingatlas/Projects/Paper2Code/src/data/datasets.py)

It is structured as a module docstring and aligned with:
- the paper methodology,
- your provided design interfaces (without adding new public APIs),
- `config.yaml` as the only source for fixed values,
- artifact contracts and reproducibility constraints for `Stage1Dataset`, `Stage2Dataset`, `Stage3Dataset`, and downstream eval datasets.